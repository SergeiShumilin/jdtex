\documentclass[a4paper,10pt]{extarticle}                     % a4 document with font 14pt

\usepackage[top=2cm,left=2cm,right=2cm,bottom=2cm]{geometry} % margins
\usepackage[utf8]{inputenc}                                  % for MikTex editor support
\usepackage[T2A]{fontenc}                                    % for russian encoding support
\usepackage[russian]{babel}                                  % russian encoding on
\usepackage{amsmath,amsthm,amscd,amsfonts,amssymb}           % special symbols, etc.
\usepackage{indentfirst}                                     % paragraph first word indentation
\usepackage{textcomp}                                        % text in formulas
\usepackage{graphicx}                                        % graphics on

\numberwithin{equation}{section}                             % section numbering for formulas
\numberwithin{figure}{section}                               % section numbering for pictures

\theoremstyle{plain}                                         % theorem style
\newtheorem{theorem}{Теорема}[section]                       % theorem
\newtheorem{lemma}{Лемма}[section]                           % lemma
\newtheorem{definition}{Определение}[section]                % definition

\begin{document}

\title{TODO: name of article}
\author{Алексей Рыбаков \\ rybakov.aax@gmail.com}
\date{Март, 2015}
\maketitle

\section{Основные соглашения и определения}

Точку в пространстве будем задавать ее радиус-вектором - вектором, направленным из начала координат в рассматриваемую точку ($\overline{P}$).

Прямую в трехмерном пространстве будем задавать \textit{опорной точкой} $\overline{P_0}$ и \textit{направляющим вектором} $\overline{V}$ ($L = (\overline{P_0}, \overline{V})$).
Геометрическое место точек прямой описывается следующим образом:

\begin{equation}
    L = \{ \overline{P(t)} = \overline{P_0} + t\overline{V} \ | \ t \in \mathbb{R} \}.
\end{equation}

Сферу в трехмерном пространстве будем задавать ее центром $\overline{C}$ и радиусом $R$ ($S = (\overline{C}, R)$).
Геометрическое местов точек поверхности сферы описывается следующим образом:

\begin{equation}
    S = \{ \overline{P} \ | \ {|\overline{P} - \overline{C}|}^2 = R^2 \}.
\end{equation}

\begin{definition}
Пучком сфер, опирающимся на отрезок, концами которого являются точки пространства $\overline{P_1}$ и $\overline{P_2}$, будем называть семейство сфер $S(\alpha) = (\overline{C(\alpha)}, R(\alpha))$, где центры и радиусы сфер задаются следующими соотношениями:
\begin{equation}
    \begin{cases}
        \overline{C(\alpha)} = \overline{P_1} + \alpha(\overline{P_2} - \overline{P_1}) = \overline{P_1} + \alpha \overline{V_{12}}, \\
        R(\alpha) = R_1 + \alpha(R_2 - R_1) = R_1 + \alpha R_{12},
    \end{cases}
\end{equation}
где $\alpha \in [0; 1]$.
Обозначать пучок сфер будем
\begin{equation}
    \mathcal{S}(S(\alpha \in [0; 1])]) = \mathcal{S}(S_1, S_2),
\end{equation}
где $S_1 = (\overline{P_1}, R_1), \ S_2 = (\overline{P_2}, R_2)$.
\end{definition}

\section{Поиск точек пересечения прямой со сферой}

Пусть дана прямая $L = (\overline{P_0}, \overline{V})$ и сфера $S = (\overline{C}, R)$.
Требуется найти точки их пересечения.
Таких точек может не быть, быть ровно одна (в случае касания) или быть две.
Для поиска точек пересечения требуется решить следующую систему уравнений относительно $t$:

\begin{equation}
    \begin{cases}
        \overline{P} = \overline{P_0} + t\overline{V}, \\
        {|\overline{P} - \overline{C}|}^2 = R^2.
    \end{cases}
\end{equation}

Без ограничения общности можно считать, что $\overline{P_0} = \overline{0}$, так как мы всегда можем добиться этого с помощью замены:

\begin{equation}
    \begin{cases}
        \overline{P_0'} = \overline{0}, \\
        \overline{C'} = \overline{C} - \overline{P_0}.
    \end{cases}
\end{equation}

Таким образом, требуется решить следующую систему уравнений относительно $t$:

\begin{equation}
    \begin{cases}
        \overline{P} = t\overline{V}, \\
        {|\overline{P} - \overline{C}|}^2 = R^2.
    \end{cases}
\end{equation}

Подставляя $\overline{P}$ из первого уравнения во второе, получим квадратное уравнение относительно $t$:

\begin{eqnarray}
    {|t\overline{V} - \overline{C}|}^2 = R^2, \\
    {|\overline{V}|}^2t^2 - 2(\overline{C}\cdot\overline{V})t + ({|\overline{C}|}^2 - R^2) = 0.
\end{eqnarray}

Дискриминант этого уравнения равен $4\left((\overline{C}\cdot\overline{V})^2 - {|\overline{V}|}^2({|\overline{C}|}^2 - R^2)\right)$.
Так как значение дискриминанта может быть вычислено непосредственно, то дальнейший поиск точек пересечения не представляет сложности.
Если значение дискриминанта отрицательно, то точек пересечения нет.
Если значение дискриминанта положительно, то точек пересечения ровно две.
Равенство дискриминанта нулю означает касание прямой и сферы.

\end{document}

